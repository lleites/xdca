<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>XCDA</title>
  <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
  <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
  <style>
    body {
      background-color: #114976;
    }
    .container {
      float: center;
      width:80%;
      margin-left:10%;
      margin-right:10%;
    }
  </style>
</head>

<body>
  <py-env>
    - matplotlib
  </py-env>

  <py-script>
    import json

    import matplotlib.pyplot as plt
    from pyodide.http import open_url

    def plot():
      ticker = Element('ticker').element.value

      url = f"stats/{ticker}"
      data = json.loads(open_url(url).getvalue())
      min_avg_freq = data["min_avg_freq"]

      plt.clf()
      plt.bar(min_avg_freq.keys(), min_avg_freq.values())
      plt.title(ticker.upper())

      pyscript.write("lineplot", plt)

    plot()

  </py-script>

  <div class="container">
    <div id="lineplot"></div>

    <div style="float: right;">
      <py-label for="ticker" style="color:white">Ticker: </py-label>
      <input type="text" id="ticker" value="TWKS" style="border-radius: 5px;"/>
      <py-button id="click" label="Calculate">
        from pyodide import create_proxy

        @create_proxy
        def on_click(evt):
          plot()
      </py-button>
    </div>
  </div>

</body>

</html>